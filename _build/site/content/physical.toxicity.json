{"version":2,"kind":"Notebook","sha256":"95e459f6e394304b6d9ffb15bb1067d38492ec54fac80e21add9dacedc3813ec","slug":"physical.toxicity","location":"/physical/14-Toxicity.ipynb","dependencies":[],"frontmatter":{"title":"14-Toxicity","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"jupiterbook","language":"python"},"authors":[{"nameParsed":{"literal":"Clint Guymon","given":"Clint","family":"Guymon"},"name":"Clint Guymon","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Brigham Young University","given":"Brigham Young","family":"University"},"name":"Brigham Young University","id":"contributors-myst-generated-uid-1"}],"date":"2025-12-25","github":"https://github.com/clint-bg/safetyinjc","keywords":["Process Safety","Chemical Engineering","Risk Assessment"],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/clint-bg/safetyinjc/blob/main/physical/14-Toxicity.ipynb","thumbnail":"/67ed83e8495a27c7358407d0fd887e0a.png","thumbnailOptimized":"/67ed83e8495a27c7358407d0fd887e0a.webp","exports":[{"format":"ipynb","filename":"14-Toxicity.ipynb","url":"/14-Toxicity-e2eba751cfe837bf93b719972dd40002.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Learning Objectives:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JPHYLzlZST"}],"key":"DtSDbipAy0"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Learn how toxicants enter and are eliminated from the body.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"dZOeuFvmJJ"}],"key":"BBXdePhU5n"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Understand effects of toxicants, including response vs. dose","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f7LQjupZ4C"}],"key":"Iv2Kb3X8fe"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Use probit equations to determine response to dose.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"CloEL4KvSr"}],"key":"EHJQwPkN9T"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Understand exposure limits such as Threshold Limit Value (TLV) and Permissible Exposure Limit (PEL).","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wtr7j30ILs"}],"key":"hfmQgtKkwl"}],"key":"xjfpn8sERy"}],"key":"TBGC5uq4oD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Entry Routes of Toxicants","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LTJqq1L55x"}],"identifier":"entry-routes-of-toxicants","label":"Entry Routes of Toxicants","html_id":"entry-routes-of-toxicants","implicit":true,"key":"YuQFwPzAR2"},{"type":"table","position":{"start":{"line":2,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Route","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rlsHSGY8s3"}],"key":"b0Kmz5DtJJ"},{"type":"tableCell","header":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Entry","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yMlV0O6Dim"}],"key":"fjNJJiA7OZ"},{"type":"tableCell","header":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Control/ Safeguards","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bHzbHTb7Nx"}],"key":"E5P9NrwmNz"}],"key":"m8h13nFY6O"},{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Inhalation","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"xb8YGcEtpv"}],"key":"S4W4suNM1s"},{"type":"tableCell","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Lungs","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EbDjgvuzUd"}],"key":"xxktjDo5V7"},{"type":"tableCell","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Ventilation, respirators, hoods","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TtFJNARBDs"}],"key":"EKMJQb0GJ1"}],"key":"jgKxpluIFc"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Ingestion","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"oD0RyJM7og"}],"key":"hYhh1r5n08"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Mouth","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JerPVbm00o"}],"key":"ZblebNViVg"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Hygiene, gloves, Guidelines on eating, drinking, etc","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"LbSS3R1RX9"}],"key":"rdfULywtsD"}],"key":"yQuPRznrUd"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Injection","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Dz7WKpLYot"}],"key":"f25nL48BKa"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Skin","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rxYgMowhb8"}],"key":"V9KYJCzqQi"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Gloves, protective clothing","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"O6rzP07lye"}],"key":"j2OFMFMCSj"}],"key":"dNSCCw94TJ"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Absorption","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"QOu6U7QFd6"}],"key":"hjIG0EEFwc"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Skin","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"vHT3C8YodS"}],"key":"NHvIGiatqc"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Gloves, protective clothing","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yDxxOmt5Ly"}],"key":"us7JBjxOB2"}],"key":"KHZW9tzQCk"}],"key":"pRCNa2RY4l"}],"key":"fn8tRrGWsy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Toxin Blood Concentration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R1Mbsz4Fxb"}],"identifier":"toxin-blood-concentration","label":"Toxin Blood Concentration","html_id":"toxin-blood-concentration","implicit":true,"key":"e1hh9nzMTA"}],"key":"jAsPJ1mxOS"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/67ed83e8495a27c7358407d0fd887e0a.png","width":500,"key":"vspnuJ2vfw","urlSource":"https://github.com/clint-bg/safetyinjc/blob/main/physical/supportfiles/toxinblood.png?raw=true","urlOptimized":"/67ed83e8495a27c7358407d0fd887e0a.webp"}],"key":"qFOQUo9FMH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Responses to Toxicants","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wTnRenzuwh"}],"identifier":"responses-to-toxicants","label":"Responses to Toxicants","html_id":"responses-to-toxicants","implicit":true,"key":"FGoM5U4m88"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Irreversible Effects:","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aZgUOxEiVH"}],"key":"pYnDiO2SGR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Cancinogens (cancer)\nLike asbestos, tobacco, formaldehyde, and ionizing radiation","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rfhpzKd5d2"}],"key":"ds94VRurOn"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Mutagens (genetic changes)\nAlkylating agents like diethyl sulfate and others","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bApAjSb88d"}],"key":"RHDSyTji6r"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Teratogens (birth defects)\nLike alcohol, lead, mercury, and thalidomide","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ND5cYQMVf0"}],"key":"o2r8xfyAAi"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Reproductive toxins\nLike lead, mercury, and cadmium","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"zRZjMLcb2v"}],"key":"GBt1JzP7cz"}],"key":"o1etdo9OVo"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Reversible Effects:","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"RrQtRiIrlg"}],"key":"cy9Hhfv8dQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":14,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Dermatotoxicants (skin)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"mT84yV4Qf3"}],"key":"IAaCJUtM2T"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Neurotoxicants (nervous system)","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"uNV28ZAKAY"}],"key":"IzKkrrvwgc"},{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Hepatotoxicants (liver)","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ADdQdqo2ko"}],"key":"QM6HvsGqNR"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Nephrotoxicants (kidneys)","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"TFM1udMXWp"}],"key":"D9LwzXASbP"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"Pulmonotoxicants (lungs)","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"sAHjAtu6in"}],"key":"VbRhnrao2H"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Hemotoxicants    (blood)","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"pR2KGAC6Gg"}],"key":"lm76veUPEd"}],"key":"gCu8akBJoT"}],"key":"y30lvEz5wi"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Toxin Storage and Elimination","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BKEhKOxHBo"}],"identifier":"toxin-storage-and-elimination","label":"Toxin Storage and Elimination","html_id":"toxin-storage-and-elimination","implicit":true,"key":"GKv1Z7yhJv"}],"key":"mUyYwAc9hb"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/bfa538e3a43e5779f07737076e2175fc.png","width":500,"key":"vcB1QS8SOt","urlSource":"https://github.com/clint-bg/safetyinjc/blob/main/physical/supportfiles/elimination.png?raw=true","urlOptimized":"/bfa538e3a43e5779f07737076e2175fc.webp"}],"key":"Gk6ugXmmyd"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Excretion: kidneys (urine), liver (bile), lungs (breath), skin (sweat)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zsjo5Uj0se"}],"key":"dqfHuznclT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Detoxification: liver (chemical changes through enzymes)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h0mf63T7sh"}],"key":"R3RPAc3gZp"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Storage: fat, bone, hair, nails, etc.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TX7N3NWp9N"}],"key":"rFagHNwU4W"}],"key":"koSU0b3eqG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dose-Response Relationships","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uGgQEpYrfP"}],"identifier":"dose-response-relationships","label":"Dose-Response Relationships","html_id":"dose-response-relationships","implicit":true,"key":"noL8BFhZOd"}],"key":"L9le8zrkIS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Suppose we have the following data from a toxicology study with mice:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hWN9wXk209"}],"key":"ZsT6H8dy22"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Dose (mg/kg)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NRRASyajQg"}],"key":"FyfbvPy3rj"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Response (Death)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Cflij0Yoqn"}],"key":"Yz3NlYQl0I"}],"key":"atvqP0VjLM"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"0.1","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eK8Tb4GpkX"}],"key":"BBHd1lb2jS"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jK4Mhqa8t0"}],"key":"HPDQyVUq6V"}],"key":"K0o6K1asnt"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"0.2","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CHYmqDEXCy"}],"key":"JQGuqk43vA"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"SYKgfIpUZ2"}],"key":"hzmVtYbT01"}],"key":"BIXcqqKTEd"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"0.3","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Y73O3E4QEy"}],"key":"buqvE0nUDM"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Mh1bMXExdo"}],"key":"SJQEEtP1RR"}],"key":"mJivkInu2Q"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"0.4","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lfJrnlSfta"}],"key":"RqO775m49M"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"0","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"bh0qUp62dA"}],"key":"LcIEcvSmbY"}],"key":"HHpKD4VxvT"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"0.5","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TYdFpwgFAq"}],"key":"Hko1WyTiQh"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"1 of 20","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"sQjJRW7AIG"}],"key":"sO4jLMq0Ve"}],"key":"ojzJFjgIhC"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"0.75","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"c0qWfQ5Hg1"}],"key":"mEO3JKIwDq"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"2 of 20","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MqVDNNBV10"}],"key":"UuQcUb0KUp"}],"key":"fAFMOFm62R"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"1.0","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"DTO1Lb5CZM"}],"key":"Jy7LdcICUx"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"5 of 20","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"H5SC9BHykq"}],"key":"UYem9pport"}],"key":"W5M1XilmcQ"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"1.25","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"p5KeHm2z2X"}],"key":"HZ7dVO5iG2"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"12 of 20","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"Kae0Dr2wiF"}],"key":"lKU85Sx6eX"}],"key":"Hkx8RrOWEl"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"2","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LS53Nps8Xa"}],"key":"wJqN0oCFs8"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"13 of 20","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Tt6BkRAUvn"}],"key":"s6I44GyDEp"}],"key":"gj2lTfC4Lb"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"5","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ZufdiQZH7f"}],"key":"UdE1Cdl71N"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"19 of 20","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"Lwgwb0zTxa"}],"key":"Qw9oPzIpLH"}],"key":"HvwvVVWjJr"}],"key":"vlhpHucOYS"}],"key":"jMyOmwF89U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd","key":"uG66noXAp1"},{"type":"output","id":"O_KZr3ETcjIIhhC8fLLtv","data":[],"key":"hutl7IU7eq"}],"key":"gIs8GTvHtk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"data = {'Dose (mg/kg)': [0.1, 0.2, 0.3, 0.4, 0.5, 0.75, 1.0, 1.25, 2, 5], 'Response (Death)': [0, 0, 0, 0, 1, 2, 5, 12, 13, 19]}\ndf = pd.DataFrame(data)\ndf['Fraction (Death)'] = df['Response (Death)'] / 20","key":"hHDwDbq7zm"},{"type":"output","id":"4UIFyk-SNRqLgXmGQSRwI","data":[],"key":"aGwIQDeRpF"}],"key":"yRydIxhd05"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df.plot(x='Dose (mg/kg)', y='Fraction (Death)', kind='scatter')","key":"pLPUWo3nuY"},{"type":"output","id":"zNg5uAUHXN7OmwqjjXMFu","data":[{"output_type":"execute_result","execution_count":36,"metadata":{},"data":{"text/plain":{"content":"<Axes: xlabel='Dose (mg/kg)', ylabel='Fraction (Death)'>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1c90e2595b65a596f061fc9e6b562627","path":"/1c90e2595b65a596f061fc9e6b562627.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"z8sM6mckiN"}],"key":"toE7EPuGfs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Some questions we might ask:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W3IxfSZ5hq"}],"key":"bELXFjCwi8"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Were the mice that survived a lower dose then dosed with a higher dose?","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"YDx3zIK0Uf"}],"key":"kh4dGSwG9S"},{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"How does this toxicant affect humans? In the same way as mice?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Itp4gRZC0M"}],"key":"yyEbUmB3ti"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"What is the LD50 (lethal dose for 50% of the population)?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"q2vDMdBUjU"}],"key":"bMJ0fKqRdD"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"What would be a threshold dose?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Usiyzv70rD"}],"key":"KiX2cy24sV"}],"key":"L85HFJ4F4d"}],"key":"R40cQ3U0H6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we fit a response curve to the data, we can answer some of those questions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rYY5EjtzRC"}],"key":"t7I7vI3F1W"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Lets fit a gaussian curve to the data and see what we get.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"AbMXqUnHpr"}],"key":"wpnZjK7g0N"}],"key":"fYvTjBmx8q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# fit a cumulative gaussian to the data\nfrom scipy.optimize import curve_fit\nfrom scipy.stats import norm\n\ndef cumulative_gaussian(x, mu, sigma):\n    return norm.cdf(x, mu, sigma)\n\npopt, pcov = curve_fit(cumulative_gaussian, df['Dose (mg/kg)'], df['Fraction (Death)'])\n\nx = np.linspace(0, 5, 100)\ny = cumulative_gaussian(x, *popt)\n\ndf.plot(x='Dose (mg/kg)', y='Fraction (Death)', kind='scatter')\nplt.plot(x, y, label='fit'); plt.grid()\nplt.show()\n","key":"NnkWFoK7Ha"},{"type":"output","id":"EYAXXZHcScY6DWv0xMzI_","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8ca4a0f8dd53c092d5df6575fbc417a8","path":"/8ca4a0f8dd53c092d5df6575fbc417a8.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"mgb9ReCnOx"}],"key":"iwn6RJR0QU"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What’s the cumulative distribution function for a gaussian curve?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TUX88qvakg"}],"key":"aAgXOxERdA"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"It is the integral of the gaussian curve from negative infinity to x...","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KrUxoR9oDt"}],"key":"u9s1EQJDke"}],"key":"Zmj8shPDtE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# plot of the gaussian curve\nx = np.linspace(-5, 5, 100)\ny = norm.pdf(x, 0, 1)\ny2 = norm.cdf(x, 0, 1)\nplt.plot(x, y, label='pdf'); \nplt.plot(x, y2, label='cdf');\nplt.xlabel('x'); plt.ylabel('pdf(x), cdf(x)'); plt.legend();\nplt.show()","key":"mWD93B8LFW"},{"type":"output","id":"avaluEMuecDEmpHoPuFcz","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"90dfe52fe2b898e6c26a28ab69b56ecd","path":"/90dfe52fe2b898e6c26a28ab69b56ecd.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"k0KEietcO2"}],"key":"LFi3m8x20G"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From the above cumulative fit, we can calculate the LD50 and the threshold dose.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U4GNKpvipp"}],"key":"BUxzce3BA6"}],"key":"orxKT6crjg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Calculation of the LD50 and threshold dose\n\n# LD50\nmu, sigma = popt\nld50 = norm.ppf(0.5, mu, sigma) # ppf is the inverse of the cdf\n#print the LD50 with 2 decimal places\nprint('LD50:', round(ld50, 2), 'mg/kg')\n\n# threshold dose\nthreshold = norm.ppf(0.01, mu, sigma)\nprint(f'Threshold: {threshold:.2f} mg/kg')","key":"eiWA02Zuk1"},{"type":"output","id":"cgjWCJanAe0MhpDdcyM3-","data":[{"name":"stdout","output_type":"stream","text":"LD50: 1.45 mg/kg\nThreshold: -0.18 mg/kg\n"}],"key":"dj7VZJ6dhJ"}],"key":"rmpVc3Lr7c"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we’ve given an estimate of the LD50 and the threshold dose (LD01). But wait, a negative value for the dose? That doesn’t make sense.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eEV9paocaM"}],"key":"CIxhkZh7W8"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In order to prevent that from happening, we can transform the dose or causitive variable (use the logarithmic function).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UnTWKdjPAL"}],"key":"ntscSQudbf"}],"key":"wDJbBekuoE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# log dose\ndf['log Dose'] = np.log(df['Dose (mg/kg)'])\n\n# fit the cumulative gaussian to the log dose\npopt, pcov = curve_fit(cumulative_gaussian, df['log Dose'], df['Fraction (Death)'])\nx = np.linspace(-3, 2, 100)\ny = cumulative_gaussian(x, *popt)\ndf.plot(x='log Dose', y='Fraction (Death)', kind='scatter')\nplt.plot(x, y, label='fit'); \nplt.show()","key":"HY0kdSmpVx"},{"type":"output","id":"0WaxVUuRJiZarpZyCzAV9","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d758e9dc8517c4e7fad47a52ab0a2e37","path":"/d758e9dc8517c4e7fad47a52ab0a2e37.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"hvPlSNgLGN"}],"key":"gONNj6Kbkq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now lets try again on determining the LD50 and threshold dose.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ma8ltcrmgp"}],"key":"Q8SpFQwf6e"}],"key":"ppqaL2U7Qa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Calculation of the LD50 and threshold dose\n\n# LD50\nmu, sigma = popt\nld50 = np.exp(norm.ppf(0.5, mu, sigma)) # we need to transform back to the original scale with np.exp\n#print the LD50 with 2 decimal places\nprint('LD50:', round(ld50, 2), 'mg/kg')\n\n# threshold dose\nthreshold = np.exp(norm.ppf(0.01, mu, sigma)) # we need to transform back to the original scale with np.exp\nprint(f'Threshold: {threshold:.2f} mg/kg')","key":"oKXrecN62u"},{"type":"output","id":"Y2HSbEOrjN9yBkuK2Lkvd","data":[{"name":"stdout","output_type":"stream","text":"LD50: 1.37 mg/kg\nThreshold: 0.33 mg/kg\n"}],"key":"WwWdTfVIk3"}],"key":"JE8OygrciL"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There is a slight difference in the LD50, which is expected as the weighting is different for the data in log space. In this case it is more conservative.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a3VsoOaiI0"}],"key":"EW6PxntnWg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The threshold dose (1% chance of death) is also different (not negative) and thus realistic.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cZFDRHxe5R"}],"key":"sxaYMCWz6f"}],"key":"ORg7ut573v"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Probit Equation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BzD3LFkbRL"}],"identifier":"probit-equation","label":"Probit Equation","html_id":"probit-equation","implicit":true,"key":"ttGmPociMV"}],"key":"o9ACvopE2A"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It can be convenient to use the probit equation to determine the response to a dose. The probit equation is essentially the inverse of the cumulative distribution function of the normal distribution and can be use to linearize the dose-response relationship.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YP6dk34RV9"}],"key":"dFuyjt6hpV"}],"key":"XDyOEtjruC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Transforming the fraction to a probit value...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bP4m6AUTcv"}],"key":"ZYFDINPrXx"}],"key":"mHfQtbvrdD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# transform of the probability or fraction response to probit\ndef probit(p):\n    return 5 + norm.ppf(p)\n","key":"kUSVcpGWJQ"},{"type":"output","id":"bfMdfU21IgpuQRQIOmbHS","data":[],"key":"yM1fb7pXr1"}],"key":"KwphEI0TJs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df['Probit'] = probit(df['Fraction (Death)'])","key":"TvhPEfGPvw"},{"type":"output","id":"0ZApxOOtmKWBjI1-8mfJF","data":[],"key":"NzYnK7OS8X"}],"key":"emW2v5tzLn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"df","key":"aXqqPBijJi"},{"type":"output","id":"2xZj1ogYPRufxNTBEe3Qg","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Dose (mg/kg)</th>\n      <th>Response (Death)</th>\n      <th>Fraction (Death)</th>\n      <th>log Dose</th>\n      <th>Probit</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0.10</td>\n      <td>0</td>\n      <td>0.00</td>\n      <td>-2.302585</td>\n      <td>-inf</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>0.20</td>\n      <td>0</td>\n      <td>0.00</td>\n      <td>-1.609438</td>\n      <td>-inf</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>0.30</td>\n      <td>0</td>\n      <td>0.00</td>\n      <td>-1.203973</td>\n      <td>-inf</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>0.40</td>\n      <td>0</td>\n      <td>0.00</td>\n      <td>-0.916291</td>\n      <td>-inf</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>0.50</td>\n      <td>1</td>\n      <td>0.05</td>\n      <td>-0.693147</td>\n      <td>3.355146</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>0.75</td>\n      <td>2</td>\n      <td>0.10</td>\n      <td>-0.287682</td>\n      <td>3.718448</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>1.00</td>\n      <td>5</td>\n      <td>0.25</td>\n      <td>0.000000</td>\n      <td>4.325510</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>1.25</td>\n      <td>12</td>\n      <td>0.60</td>\n      <td>0.223144</td>\n      <td>5.253347</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>2.00</td>\n      <td>13</td>\n      <td>0.65</td>\n      <td>0.693147</td>\n      <td>5.385320</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>5.00</td>\n      <td>19</td>\n      <td>0.95</td>\n      <td>1.609438</td>\n      <td>6.644854</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"   Dose (mg/kg)  Response (Death)  Fraction (Death)  log Dose    Probit\n0          0.10                 0              0.00 -2.302585      -inf\n1          0.20                 0              0.00 -1.609438      -inf\n2          0.30                 0              0.00 -1.203973      -inf\n3          0.40                 0              0.00 -0.916291      -inf\n4          0.50                 1              0.05 -0.693147  3.355146\n5          0.75                 2              0.10 -0.287682  3.718448\n6          1.00                 5              0.25  0.000000  4.325510\n7          1.25                12              0.60  0.223144  5.253347\n8          2.00                13              0.65  0.693147  5.385320\n9          5.00                19              0.95  1.609438  6.644854","content_type":"text/plain"}}}],"key":"bb4FnzUbsW"}],"key":"T5Y9XyxskO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# plot of the data with the probit scale\ndf.plot(x='log Dose', y='Probit', kind='scatter')\nplt.plot(x, probit(y), label='fit')","key":"BHCHnWehF5"},{"type":"output","id":"D0IjsAkdeAhZvZN-771fy","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5c6d23cd02aa64bcd8c7ab872bb894b1","path":"/5c6d23cd02aa64bcd8c7ab872bb894b1.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}}],"key":"xwhKnFwBsK"}],"key":"Az1k5jkjnN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Instead of fitting a gaussian and then transforming the dose, we can fit the probit equation directly to the data. This will give us the two probit constants k1 (intercept) and k2 (slope) referenced in Table 2-5 in the textbook (Crowl and Louvar).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j9FDiQhfHY"}],"key":"RnN2T8ink0"}],"key":"ZDFhNeEATQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# fit a line (probit linear model) to the data\n#first drop -inf values\ndf = df[df['Probit'] > 0]\n\nk2,k1 = np.polyfit(df['log Dose'], df['Probit'], 1) # the first value is the slope and the second the intercept\nprint(f'k1: {k1:.2f}, k2: {k2:.2f}')","key":"eZI66UdTZ7"},{"type":"output","id":"_13fWab_SH7T7EzhFBwn9","data":[{"name":"stdout","output_type":"stream","text":"k1: 4.40, k2: 1.47\n"}],"key":"tEYQRPyd6p"}],"key":"ZvhKumotli"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Once we have the probit constants, we can use them to determine the response to any dose, including the LD50 and threshold dose.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"k0DiBcg7wu"}],"key":"v4hUP4gFhR"}],"key":"g5YiQDQRfh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#using the probit constants to calculate the LD50 and threshold dose\nld50_log = (5 - k1) / k2 \nld50 = np.exp(ld50_log)\nprint(f'LD50: {ld50:.2f} mg/kg')\n\n# threshold dose\nthreshold_log = (probit(0.01) - k1) / k2\nthreshold = np.exp(threshold_log)\nprint(f'Threshold: {threshold:.2f} mg/kg')","key":"i7SZaP8Epy"},{"type":"output","id":"zbrrSUBpBDhgPlaMR-bUa","data":[{"name":"stdout","output_type":"stream","text":"LD50: 1.50 mg/kg\nThreshold: 0.31 mg/kg\n"}],"key":"cOlcJC2Jp0"}],"key":"gJ9ZpOTNIo"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can also transform from probit back to fraction response...","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cqnzXSZdDk"}],"key":"r0lMTzo4nE"}],"key":"qF2yIMzLsn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import math\ndef P(Y):\n    if Y != 5:\n        return 0.50*(1+(Y-5)/(abs(Y-5))*math.erf(abs(Y-5)/math.sqrt(2)))\n    else:\n        return 0.50","key":"fmQocuer9z"},{"type":"output","id":"Jr2LoifRa_qz05Vh_P2rw","data":[],"key":"paOjqOBaqp"}],"key":"dQt2gr7Mxq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Probit Correlation Example","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pT0gv4Lq5Z"}],"identifier":"probit-correlation-example","label":"Probit Correlation Example","html_id":"probit-correlation-example","implicit":true,"key":"mmRyvVQrmb"}],"key":"H4Gl7DtX5V"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Suppose we use Table 2-5 in the textbook (Crowl and Louvar) to estimate the probability of death from exposure to a fireball (say the sun). The causitive variable is ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"COLPrZKwFg"},{"type":"inlineMath","value":"t_{exposure}\\cdot I^{4/3}","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>t</mi><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mi>o</mi><mi>s</mi><mi>u</mi><mi>r</mi><mi>e</mi></mrow></msub><mo>⋅</mo><msup><mi>I</mi><mrow><mn>4</mn><mi mathvariant=\"normal\">/</mi><mn>3</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">t_{exposure}\\cdot I^{4/3}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9012em;vertical-align:-0.2861em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"mord mathnormal mtight\">x</span><span class=\"mord mathnormal mtight\">p</span><span class=\"mord mathnormal mtight\">os</span><span class=\"mord mathnormal mtight\">u</span><span class=\"mord mathnormal mtight\">re</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2861em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.888em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">I</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4/3</span></span></span></span></span></span></span></span></span></span></span></span>","key":"qbsF2MWuWs"},{"type":"text","value":"/1E4 where I is the radiation intensity. Say we stay out in the sun for 8 hours. The typical radiation intensity in full sun is 1000 W/m^2. What is the probability of death?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rn0nhvXlTs"}],"key":"ObM5RS3BBy"}],"key":"kUQ6wqd09D"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"lsWNW4qVBM"},{"type":"output","id":"gpzjL4SwLDtn91VD7QRny","data":[],"key":"TLR9lISzTT"}],"key":"XzHCNRqNLg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"mIViicPGuz"},{"type":"output","id":"xdtGfGgHbEgNHoXbtenL2","data":[],"key":"e3it89r2rq"}],"key":"x9kbzYSfEw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"TLV and PEL","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vkRi0OzNF3"}],"identifier":"tlv-and-pel","label":"TLV and PEL","html_id":"tlv-and-pel","implicit":true,"key":"s06PgPPqD8"}],"key":"XXCUjxXJpR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"TLV (Threshold Limit Value) and PEL (Permissible Exposure Limit) are exposure limits for toxicants. They are typically given in units of concentration (e.g. ppm, mg/m^3).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z6N37zrNkC"}],"key":"PfPyNp6vPg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"TLV-TWA (Time Weighted Average) is the average concentration over an 8-hour workday that is believed to be safe for most workers.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NrO3TOyHOY"}],"key":"kygk9upQxx"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"TLV-STEL (Short Term Exposure Limit) is the maximum concentration for a short period of time (15 minutes) that is expected to be safe.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Goj26tA628"}],"key":"QwkIPkVpfU"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"TLV-C (Ceiling) is the maximum concentration that should never be exceeded.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JKqiIwyNTP"}],"key":"PAP4YvY5wt"}],"key":"YOWVnYujAS"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"These TLV values are established by the American Conference of Governmental Industrial Hygienists (ACGIH).","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TFVzYMxxbb"}],"key":"mXWpUXjrol"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"OSHA (Occupational Safety and Health Administration) has established PEL values which are similar to TLV values.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"z3Xs7LOdEy"}],"key":"st8cXZ9QNv"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"ILDV (Immediately Dangerous to Life and Health) is the concentration that is immediately dangerous to life and health.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"esd46XgZ8j"}],"key":"Oi01dOuSkq"}],"key":"yawGl42wwI"},{"type":"block","kind":"notebook-content","children":[],"key":"A92YIeQG88"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example with Probit and TLV","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f3aZA8ZMZO"}],"identifier":"example-with-probit-and-tlv","label":"Example with Probit and TLV","html_id":"example-with-probit-and-tlv","implicit":true,"key":"I1IQZaub68"}],"key":"P8KdLHU30r"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Table 2-5 gives probit parameters for dying from ammonia. Calculate the LD50 from these parameters and compare it with the LD50 reported in the literature. Also, compare the TLV-TWA to determine a probability for death from the probit parameters.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TH0Uz4QX3N"}],"key":"vZF2KfItfQ"}],"key":"tr0IqhBhpV"}],"key":"qPML7hi1QB"},"references":{"cite":{"order":[],"data":{}}}}